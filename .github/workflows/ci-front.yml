name: Front Continuous Integration

on:
  pull_request:

jobs:
  lint:
    name: 👮 Lint & Typecheck
    runs-on: ubuntu-latest
    env:
      GQL_HOST: https://api-6zdezivzkq-ey.a.run.app
    steps:
      - uses: actions/checkout@v4
      - name: 🥟 Install bun
        uses: oven-sh/setup-bun@v2
        with:
          bun-version: '1.2.9'
      - run: bun install
      - run: bun --cwd front biome ci
      - run: bun --cwd front typecheck


  storybook-test:
    name: 📖 Test storybook
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: 🥟 Install bun
        uses: oven-sh/setup-bun@v2
        with:
          bun-version: '1.2.9'
      - run: bun install --cwd front
      - name: 🖥️ Install Playwright
        run: bun --cwd front storybook:test:install
      - name: 📖 Build Storybook
        run: bun --cwd front storybook:build
      - name: Serve Storybook and run tests
        run: bun --cwd front storybook:test
